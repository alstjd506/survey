<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.survey.mapper.SurveyMapper">
	<select id="surveyList" resultType="surveyVO">
		SELECT *
FROM (
    SELECT SURVEY_ID
         , TITLE
         , CONTENT
         , START_DT
         , END_DT
         , STATUS
         , CREATE_DT
         , UPDATE_DT
         , USER_ID
         , name
         , ROWNUM AS survey_num
    FROM (
        SELECT A.SURVEY_ID
             , A.TITLE
             , A.CONTENT
             , A.START_DT
             , A.END_DT
             , A.STATUS
             , A.CREATE_DT
             , A.UPDATE_DT
             , A.USER_ID
             , B.NCNM AS name
        FROM SV_SURVEY A
        JOIN TB_USER B
          ON A.USER_ID = B.USER_ID
        ORDER BY A.SURVEY_ID DESC
    )
    WHERE ROWNUM<![CDATA[ <= ]]> #{pageNum} * #{amount}
)
WHERE survey_num > (#{pageNum} - 1) * #{amount}
	</select>
	
	<select id="getTotalCount" resultType="int">
		SELECT COUNT(*)
		FROM SV_SURVEY A
		JOIN TB_USER B
		ON A.USER_ID = B.USER_ID
	</select>
	
	<select id="surveyPost" resultType="surveyVO">
		select *
		  from sv_survey
		 where survey_id = #{survey_id}
	
	</select>
	
</mapper>